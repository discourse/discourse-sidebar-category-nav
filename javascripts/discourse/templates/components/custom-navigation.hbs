{{#if shouldShow}}
  <div class="category-sidebar">
    <ul class="category-sidebar-list">
        <li class="category-sidebar-list-item all-topics">
          {{#link-to "discovery.latest" class="category-sidebar-list-item-link"}}
            All Topics
          {{/link-to}}
        </li>
      {{#each sidebarCategories as |sidebarCategory|}}
        <li 
          class={{concat 'category-sidebar-list-item ' 
          (if
            (or 
              (and
                (eq currentRouteCategory sidebarCategory.name)
                sidebarCategory.has_children
              )
              (childIsActive currentRoute sidebarCategory.slug)
            ) 'show-children'
          )}} 
          style="--category-color: #{{sidebarCategory.color}}"
        >
          {{#link-to "discovery.category" (concat sidebarCategory.slug "/" sidebarCategory.id) class=(concat sidebarCategory.slug " category-sidebar-list-item-link")}}
            <span class="sidebar-category-badge"></span>{{sidebarCategory.name}}
          {{/link-to}}
          {{!-- 
          2) Has a child category / the user is currently viewing 
          --}}
          {{#if
            (or 
              sidebarCategory.has_children
              (childIsActive currentRoute sidebarCategory.slug)
            )}}
            <ul class="category-sidebar-list subcategories">
              {{#each sidebarCategory.subcategories as |childCategory|}}
                <li class="category-sidebar-list-item child" style="--category-color: #{{childCategory.color}}">
                  {{#link-to "discovery.category" (concat sidebarCategory.slug "/" childCategory.slug "/" childCategory.id) class="category-sidebar-list-item-link subcategory-item"}}
                    {{childCategory.name}}
                  {{/link-to}}
                  {{#if
                    (or 
                      (eq currentRouteCategory childCategory.name)
                      childCategory.has_children
                    )}}
                    <ul class="category-sidebar-list subcategories">
                      {{#each childCategory.subcategories as |grandChildCategory|}}
                        <li class="category-sidebar-list-item grandchild" style="--category-color: #{{grandChildCategory.color}}">
                          {{#link-to "discovery.category" (concat sidebarCategory.slug "/" childCategory.slug "/" grandChildCategory.slug "/" grandChildCategory.id) class="category-sidebar-list-item-link subcategory-item grandchild"}}
                            {{grandChildCategory.name}}
                          {{/link-to}}
                        </li>
                      {{/each}}
                    </ul>
                  {{/if}}
                </li>
              {{/each}}
            </ul>
          {{/if}}
        </li>
      {{/each}}
    </ul>
  </div>
{{/if}}