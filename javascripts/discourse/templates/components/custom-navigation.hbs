{{#if shouldShow}}
  <div class="category-sidebar">
    <ul class="category-sidebar-list">
      <li class="category-sidebar-list-item all-topics">
        {{#link-to "discovery.latest" class="category-sidebar-list-item-link"}}
          All Topics
        {{/link-to}}
      </li>

      {{#each sidebarCategories as |sidebarCategory|}}
        <li
          role="button"
          {{on "click" boxClick}}
          class={{concat
            "category-sidebar-list-item category-sidebar-list-item__parent "
            (if
              (or
                (and
                  (eq currentRouteCategoryId sidebarCategory.id)
                  sidebarCategory.has_children
                )
                (child-is-active currentRouteCategoryId sidebarCategory.id)
              )
              "show-children"
            )
          }}
          style={{html-safe
            (concat "--category-color: #" sidebarCategory.color ";")
          }}
        >
          <div class="category-sidebar-list-item__parent-container">
            {{#link-to
              "discovery.category"
              (concat sidebarCategory.slug "/" sidebarCategory.id)
              class="category-sidebar-list-item-link"
              current-when=(eq currentRouteCategoryId sidebarCategory.id)
            }}
              <span
                class="sidebar-category-badge"
              ></span>{{sidebarCategory.name}}
            {{/link-to}}
            {{#if sidebarCategory.has_children}}
              <div
                class="sidebar-category-toggle"
                role="button"
                {{on "click" toggleSection}}
              > {{d-icon "chevron-right"}} </div>
            {{/if}}
          </div>
          {{#if
            (or
              sidebarCategory.has_children
              (child-is-active currentRouteCategoryId sidebarCategory.id)
            )
          }}
            <ul class="category-sidebar-list subcategories">
              {{#each sidebarCategory.subcategories as |childCategory|}}
                <li
                  class="category-sidebar-list-item child
                    {{if childCategory.subcategories 'has-children'}}"
                  style={{html-safe
                    (concat "--category-color: #" childCategory.color ";")
                  }}
                >
                  {{#link-to
                    "discovery.category"
                    (concat
                      sidebarCategory.slug
                      "/"
                      childCategory.slug
                      "/"
                      childCategory.id
                    )
                    class="category-sidebar-list-item-link subcategory-item"
                    current-when=(eq currentRouteCategoryId childCategory.id)
                  }}
                    {{childCategory.name}}
                  {{/link-to}}

                  {{#if
                    (or
                      (eq currentRouteCategoryId childCategory.id)
                      childCategory.has_children
                    )
                  }}
                    <ul class="category-sidebar-list sub-subcategories">
                      {{#each
                        childCategory.subcategories
                        as |grandChildCategory|
                      }}
                        <li
                          class="category-sidebar-list-item grandchild"
                          style={{html-safe
                            (concat
                              "--category-color: #" grandChildCategory.color ";"
                            )
                          }}
                        >
                          {{#link-to
                            "discovery.category"
                            (concat
                              sidebarCategory.slug
                              "/"
                              childCategory.slug
                              "/"
                              grandChildCategory.slug
                              "/"
                              grandChildCategory.id
                            )
                            class="category-sidebar-list-item-link subcategory-item grandchild"
                            current-when=(eq
                              currentRouteCategoryId grandChildCategory.id
                            )
                          }}
                            {{grandChildCategory.name}}
                          {{/link-to}}
                        </li>
                      {{/each}}
                    </ul>
                  {{/if}}
                </li>
              {{/each}}
            </ul>
          {{/if}}
        </li>
      {{/each}}
    </ul>
  </div>
{{/if}}